{% extends "configuracion.html" %}
{% load static %} 
{% block body %}

<link rel="stylesheet" href="{% static 'css/config/hero.css' %}">

<div class="container py-4">
    <div class="row">
        <div class="col-md-8">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h2 class="display-5 fw-semibold">Configuración del Hero</h2>
            </div>
            
            <!-- Sección de Imagen de Fondo -->
            <div class="card shadow-sm mb-4">
                <div class="card-header bg-light">
                    <h5 class="card-title mb-0">
                        <i class="bi bi-image-fill me-2"></i>Imagen de Fondo
                    </h5>
                </div>
                <div class="card-body">
                    <form method="post"  class="needs-validation" enctype="multipart/form-data" novalidate>
                        {% csrf_token %}
                                        <!-- Vista previa de imagen principal -->
                                        <div id="hero-image-preview" class="mb-3">
                                            {% if hero.background_image %}
                                                <div class="card" style="max-width: 400px;">
                                                    <img src="{{ hero.background_image.url }}" 
                                                         alt="Imagen principal del hero" 
                                                         class="card-img-top"
                                                         style="height: 150px; object-fit: cover;">
                                                    <div class="card-body p-2">
                                                        <small class="text-muted d-block">Imagen principal</small>
                                                        <button type="button" class="btn btn-danger btn-sm mt-1" id="remove-hero-image">
                                                            <i class="bi bi-trash"></i> Eliminar principal
                                                        </button>
                                                    </div>
                                                </div>
                                            {% else %}
                                                <div class="alert alert-info py-2">
                                                    <i class="bi bi-info-circle me-1"></i>
                                                    <small>No hay imagen principal configurada.</small>
                                                </div>
                                            {% endif %}
                                        </div>

                                        <!-- Campos de carga de imágenes -->
                                        <div class="mb-3">
                                            <label for="{{ form.background_image.id_for_label }}" class="form-label">
                                                <i class="bi bi-image me-1"></i>Imagen Principal
                                            </label>
                                            {{ form.background_image }}
                                        </div>
                                        
                                        <!-- Imágenes adicionales existentes -->
                                        {% if additional_images %}
                                        <div class="mb-3">
                                            <h6 class="fw-semibold mb-2">
                                                <i class="bi bi-images me-1"></i>Imágenes adicionales 
                                                <small class="text-muted">({{ additional_images|length }} imagen{{ additional_images|length|pluralize:"es" }})</small>
                                            </h6>
                                            <div class="row g-2" id="additional-images-grid">
                                                {% for img in additional_images %}
                                                <div class="col-4" data-image-id="{{ img.id }}">
                                                    <div class="card position-relative">
                                                        <img src="{{ img.image.url }}" 
                                                             alt="Imagen adicional {{ forloop.counter }}" 
                                                             class="card-img-top"
                                                             style="height: 80px; object-fit: cover;">
                                                        <div class="card-img-overlay p-1 d-flex justify-content-between align-items-start">
                                                            <span class="badge bg-primary">{{ forloop.counter }}</span>
                                                            <button type="button" 
                                                                    class="btn btn-sm btn-danger remove-additional-image"
                                                                    data-image-id="{{ img.id }}"
                                                                    title="Eliminar imagen">
                                                                <i class="bi bi-trash"></i>
                                                            </button>
                                                        </div>
                                                    </div>
                                                </div>
                                                {% endfor %}
                                            </div>
                                        </div>
                                        {% endif %}
                                        
                                        <!-- Campos de carga de imágenes adicionales -->
                                        <div class="mb-3">
                                            <label for="{{ form.additional_images.id_for_label }}" class="form-label">
                                                <i class="bi bi-images me-1"></i>Imágenes Adicionales
                                            </label>
                                            <input type="file" 
                                                   name="{{ form.additional_images.name }}"
                                                   id="{{ form.additional_images.id_for_label }}"
                                                   class="form-control"
                                                   accept="image/*"
                                                   multiple>
                            <div class="form-text">
                                <small class="text-muted">Puedes seleccionar múltiples archivos. Las imágenes cambiarán automáticamente cada 5 segundos.</small>
                            </div>
                        </div>
                        
                        <div class="form-text">
                            <strong>Recomendado:</strong> 1920x1080px, formato JPG o PNG, máximo 5MB por imagen
                            <br><small class="text-muted">Para mejores resultados usar imágenes con buena calidad y resolución Full HD</small>
                        </div>
                        
                        <!-- Vista previa de archivos seleccionados -->
                        <div id="new-images-preview" class="mt-3" style="display: none;">
                            <small class="text-muted">Vista previa de archivos seleccionados:</small>
                            <div class="row g-2 mt-1" id="preview-images-grid">
                                <!-- Las imágenes se cargarán aquí via JavaScript -->
                            </div>
                        </div>                        <div class="mt-3">
                            <button type="submit" class="btn btn-primary">
                                <i class="bi bi-save"></i> Actualizar Imágenes
                            </button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Sección de Contenido de Texto -->
            <div class="card shadow-sm mb-4">
                <div class="card-header bg-light">
                    <h5 class="card-title mb-0">
                        <i class="bi bi-type me-2"></i>Contenido de Texto
                    </h5>
                </div>
                <div class="card-body">
                    <form method="post"  class="needs-validation" novalidate>
                        {% csrf_token %}
                                        <div class="row">
                                            <!-- Título Principal -->
                                            <div class="col-md-6 mb-3">
                                                <label for="{{ form.title.id_for_label }}" class="form-label">
                                                    <i class="bi bi-type-h1 me-1"></i>Título Principal
                                                </label>
                                                {{ form.title }}
                                            </div>
                                            
                                            <!-- Color del Título -->
                                            <div class="col-md-6 mb-3">
                                                <label for="{{ form.title_color.id_for_label }}" class="form-label">
                                                    Color del Título
                                                    <div class="color-preview preview-title-color"></div>
                                                </label>
                                                {{ form.title_color }}
                                            </div>
                                        </div>
                                        
                                        <div class="row">
                                            <!-- Subtítulo -->
                                            <div class="col-md-6 mb-3">
                                                <label for="{{ form.subtitle.id_for_label }}" class="form-label">
                                                    <i class="bi bi-textarea-t me-1"></i>Subtítulo
                                                </label>
                                                {{ form.subtitle }}
                                            </div>
                                            
                                            <!-- Color del Subtítulo -->
                                            <div class="col-md-6 mb-3">
                                                <label for="{{ form.subtitle_color.id_for_label }}" class="form-label">
                                                    Color del Subtítulo
                                                    <div class="color-preview preview-subtitle-color"></div>
                                                </label>
                                                {{ form.subtitle_color }}
                                            </div>
                        </div>
                        
                        <div class="mt-3">
                            <button type="submit" class="btn btn-primary">
                                <i class="bi bi-save"></i> Actualizar Texto
                            </button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Sección de Botones de Acción -->
            <div class="card shadow-sm mb-4">
                <div class="card-header bg-light">
                    <h5 class="card-title mb-0">
                        <i class="bi bi-mouse2 me-2"></i>Botones de Acción
                    </h5>
                </div>
                <div class="card-body">
                    <form method="post"  class="needs-validation" novalidate>
                        {% csrf_token %}
                                        <div class="row">
                                            <!-- Botón Primario -->
                                            <div class="col-md-6 mb-3">
                                                <label for="{{ form.btn_primary_text.id_for_label }}" class="form-label">
                                                    <i class="bi bi-cursor me-1"></i>Texto Botón Principal
                                                </label>
                                                {{ form.btn_primary_text }}
                                            </div>
                                            
                                            <!-- URL Botón Primario -->
                                            <div class="col-md-6 mb-3">
                                                <label for="{{ form.btn_primary_url.id_for_label }}" class="form-label">
                                                    <i class="bi bi-link me-1"></i>URL Botón Principal
                                                </label>
                                                {{ form.btn_primary_url }}
                                            </div>
                                        </div>
                                        
                                        <div class="row">
                                            <!-- Botón Secundario -->
                                            <div class="col-md-6 mb-3">
                                                <label for="{{ form.btn_secondary_text.id_for_label }}" class="form-label">
                                                    <i class="bi bi-cursor-text me-1"></i>Texto Botón Secundario
                                                </label>
                                                {{ form.btn_secondary_text }}
                                            </div>
                                            
                                            <!-- URL Botón Secundario -->
                                            <div class="col-md-6 mb-3">
                                                <label for="{{ form.btn_secondary_url.id_for_label }}" class="form-label">
                                                    <i class="bi bi-link-45deg me-1"></i>URL Botón Secundario
                                                </label>
                                                {{ form.btn_secondary_url }}
                                            </div>
                        </div>

                        <div class="mt-3">
                            <button type="submit" class="btn btn-primary">
                                <i class="bi bi-save"></i> Actualizar Botones
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Preview Panel -->
        <div class="col-md-4">
            <div class="card shadow-sm sticky-top" style="top: 20px;">
                <div class="card-header bg-light">
                    <h5 class="card-title mb-0">Vista Previa</h5>
                </div>
                <div class="card-body">
                    <div id="preview-hero" class="mb-4 p-3" style="border: 1px solid #ddd; border-radius: 4px; min-height: 200px; background-size: cover; background-position: center; position: relative; {% if hero.background_image %}background-image: url('{{ hero.background_image.url }}');{% endif %}">
                        <div class="preview-overlay" style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.4); border-radius: 4px;"></div>
                        <div style="position: relative; z-index: 1; color: white; text-align: center; padding: 20px;">
                            <h6 id="preview-title" style="margin-bottom: 10px;">{{ hero.title }}</h6>
                            <p id="preview-subtitle" style="font-size: 0.8rem; margin-bottom: 15px;">{{ hero.subtitle }}</p>
                            <div>
                                <small class="badge bg-primary me-1" id="preview-btn-primary">{{ hero.btn_primary_text }}</small>
                                <small class="badge bg-light text-dark" id="preview-btn-secondary">{{ hero.btn_secondary_text }}</small>
                            </div>
                        </div>
                    </div>
                    <div class="text-center">
                        <small class="text-muted">Vista previa actualizada en tiempo real</small>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="{% static 'js/hero.js' %}"></script>


{% endblock %}
