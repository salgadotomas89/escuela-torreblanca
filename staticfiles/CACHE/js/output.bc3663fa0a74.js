;$(document).ready(function(){$('#comunicadoForm').submit(function(event){event.preventDefault();var formData=new FormData(this);$.ajax({url:'comunicados/guardar-comunicado/',method:'POST',data:formData,processData:false,contentType:false,success:function(response){console.log('Comunicado guardado');$('#nuevoComunicado').modal('hide');$('#comunicadoForm')[0].reset();},error:function(error){console.error('Error al guardar el comunicado:',error);}});});});;$(window).scroll(function(){var scrollPosition=$(this).scrollTop();var windowHeight=$(this).height();$('.scroll-animation').each(function(){var elementPosition=$(this).offset().top;if(elementPosition-windowHeight+100<scrollPosition){$(this).addClass('animate');}});});;(function(){'use strict';const isMobile=/Mobi|Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);const prefersReducedMotion=window.matchMedia('(prefers-reduced-motion: reduce)').matches;const supportsIntersectionObserver='IntersectionObserver'in window;let heroParallax,heroSection,heroContent,scrollIndicator;let heroHeight=0;let isHeroVisible=true;let rafId=null;let parallaxEnabled=true;function initElements(){heroParallax=document.querySelector('.hero-parallax');heroSection=document.querySelector('.hero-section');heroContent=document.querySelector('.hero-content');scrollIndicator=document.querySelector('.scroll-arrow');if(!heroParallax||!heroSection)return false;parallaxEnabled=heroSection.dataset.parallax==='true';heroHeight=heroSection.offsetHeight;return true;}
function shouldSkipParallax(){return isMobile||prefersReducedMotion||!parallaxEnabled;}
function initElements(){heroParallax=document.querySelector('.hero-parallax');heroSection=document.querySelector('.hero-section');heroContent=document.querySelector('.hero-content');scrollIndicator=document.querySelector('.scroll-arrow');if(!heroParallax||!heroSection)return false;heroHeight=heroSection.offsetHeight;return true;}
function updateParallax(){if(shouldSkipParallax())return;const scrollTop=window.pageYOffset;isHeroVisible=scrollTop<heroHeight;if(!isHeroVisible)return;const yPos=scrollTop*0.5;const opacity=Math.max(0,1-(scrollTop/heroHeight));heroParallax.style.transform=`translate3d(0, ${yPos}px, 0)`;heroContent.style.opacity=opacity;}
function onScroll(){if(rafId)return;rafId=requestAnimationFrame(()=>{updateParallax();rafId=null;});}
let lastScrollTop=0;function handleScroll(){const scrollTop=window.pageYOffset;if(scrollTop<lastScrollTop&&scrollTop<heroHeight*1.5){isHeroVisible=true;}
lastScrollTop=scrollTop;onScroll();}
function setupIntersectionObserver(){if(!supportsIntersectionObserver)return;const observer=new IntersectionObserver((entries)=>{const heroEntry=entries[0];isHeroVisible=heroEntry.isIntersecting||heroEntry.boundingClientRect.bottom>0;if(isHeroVisible){updateParallax();}
if(!isHeroVisible&&rafId){cancelAnimationFrame(rafId);rafId=null;}},{rootMargin:'100px 0px 0px 0px',threshold:[0,0.1,0.5,1]});observer.observe(heroSection);}
function setupScrollIndicator(){if(!scrollIndicator)return;scrollIndicator.addEventListener('click',()=>{const target=document.querySelector('#noticias');if(target){target.scrollIntoView({behavior:'smooth',block:'start'});}},{passive:true});}
let resizeTimeout;function onResize(){clearTimeout(resizeTimeout);resizeTimeout=setTimeout(()=>{heroHeight=heroSection.offsetHeight;isHeroVisible=window.pageYOffset<heroHeight;},150);}
function init(){if(!initElements())return;if(shouldSkipParallax()){setupScrollIndicator();return;}
setupIntersectionObserver();setupScrollIndicator();window.addEventListener('scroll',handleScroll,{passive:true});window.addEventListener('resize',onResize,{passive:true});updateParallax();}
if(document.readyState==='loading'){document.addEventListener('DOMContentLoaded',init);}else{init();}
window.addEventListener('beforeunload',()=>{if(rafId){cancelAnimationFrame(rafId);}
clearTimeout(resizeTimeout);});})();;document.addEventListener('DOMContentLoaded',function(){const heroBackgrounds=document.querySelectorAll('.hero-bg');const heroIndicators=document.querySelectorAll('.hero-indicator');if(heroBackgrounds.length>1){let currentSlide=0;let slideInterval;function showSlide(index){heroBackgrounds.forEach(bg=>bg.classList.remove('active'));heroIndicators.forEach(indicator=>indicator.classList.remove('active'));if(heroBackgrounds[index]){heroBackgrounds[index].classList.add('active');}
if(heroIndicators[index]){heroIndicators[index].classList.add('active');}}
function nextSlide(){currentSlide=(currentSlide+1)%heroBackgrounds.length;showSlide(currentSlide);}
function startSlideshow(){slideInterval=setInterval(nextSlide,5000);}
function stopSlideshow(){if(slideInterval){clearInterval(slideInterval);}}
heroIndicators.forEach((indicator,index)=>{indicator.addEventListener('click',()=>{currentSlide=index;showSlide(currentSlide);stopSlideshow();startSlideshow();});});const heroSection=document.getElementById('hero');if(heroSection){heroSection.addEventListener('mouseenter',stopSlideshow);heroSection.addEventListener('mouseleave',startSlideshow);}
startSlideshow();}});;document.addEventListener('DOMContentLoaded',function(){const whatsappButton=document.querySelector('.whatsapp-float');if(whatsappButton){const currentHref=whatsappButton.href;const phoneMatch=currentHref.match(/wa\.me\/(\d+)/);const phoneNumber=phoneMatch?phoneMatch[1]:'56912345678';const defaultMessage='Hola, me gustaría obtener más información sobre el colegio';function getContextualMessage(){const currentPage=window.location.pathname;let message=defaultMessage;if(currentPage.includes('noticias')){message='Hola, vi una noticia en el sitio web y me gustaría obtener más información';}else if(currentPage.includes('profesores')){message='Hola, me interesa conocer más sobre el equipo docente del colegio';}else if(currentPage.includes('comunicados')){message='Hola, vi un comunicado y tengo algunas consultas';}else if(currentPage.includes('calendario')){message='Hola, necesito información sobre las fechas de evaluaciones';}
return encodeURIComponent(message);}
function updateWhatsAppLink(){const message=getContextualMessage();const whatsappURL=`https://wa.me/${phoneNumber}?text=${message}`;whatsappButton.href=whatsappURL;}
updateWhatsAppLink();whatsappButton.addEventListener('click',function(e){console.log('Usuario hizo clic en el botón de WhatsApp');});let hasScrolled=false;window.addEventListener('scroll',function(){if(!hasScrolled&&window.scrollY>100){whatsappButton.style.opacity='0';whatsappButton.style.transform='scale(0.8)';setTimeout(()=>{whatsappButton.style.transition='all 0.5s ease';whatsappButton.style.opacity='1';whatsappButton.style.transform='scale(1)';},100);hasScrolled=true;}});}});;document.addEventListener('DOMContentLoaded',function(){const cards=document.querySelectorAll('.card-hover');const observer=new IntersectionObserver((entries)=>{entries.forEach((entry,index)=>{if(entry.isIntersecting){setTimeout(()=>{entry.target.style.opacity='1';entry.target.style.transform='translateY(0)';},index*100);}});});cards.forEach(card=>{card.style.opacity='0';card.style.transform='translateY(20px)';card.style.transition='all 0.6s ease';observer.observe(card);});});document.querySelectorAll('.icon-circle').forEach(icon=>{icon.addEventListener('mouseenter',function(){this.style.transform='scale(1.1) rotate(5deg)';});icon.addEventListener('mouseleave',function(){this.style.transform='scale(1) rotate(0deg)';});});;document.addEventListener('DOMContentLoaded',function(){let eventoIdToDelete=null;const deleteModal=new bootstrap.Modal(document.getElementById('deleteEventModal'));document.querySelectorAll('.delete-event-btn').forEach(button=>{button.addEventListener('click',function(e){e.stopPropagation();eventoIdToDelete=this.getAttribute('data-evento-id');const eventoTitulo=this.getAttribute('data-evento-titulo');document.getElementById('eventTitle').textContent=eventoTitulo;deleteModal.show();});});document.getElementById('confirmDeleteBtn').addEventListener('click',function(){if(eventoIdToDelete){fetch(`/eliminar-evento/${eventoIdToDelete}/`,{method:'DELETE',headers:{'X-CSRFToken':csrfToken,'Content-Type':'application/json',},}).then(response=>{if(response.ok){location.reload();}else{alert('Error al eliminar el evento');}}).catch(error=>{console.error('Error:',error);alert('Error al eliminar el evento');});}
deleteModal.hide();});});;